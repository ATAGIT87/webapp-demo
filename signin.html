<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Signin Demo</title>
</head>
<body>
  <h1>Signin Form</h1>
  <form id="signinForm">
    <label for="username">Username:</label>
    <input type="text" id="username" name="username" required><br><br>
    <label for="password">Password:</label>
    <input type="password" id="password" name="password" required><br><br>
    <button type="submit">Sign In</button>
  </form>

 <p>Don't have an account? 
    <a href="signup.html">Sign up here</a>
  </p>
  
  <h2>Response:</h2>
  <pre id="response"></pre>

 <script type="module">
  import { AuthenticationService } from './api/services/AuthenticationService.js';
  import { OpenAPI } from './api/core/OpenAPI.js';

  OpenAPI.BASE = 'https://backend-mn3f.onrender.com';

  const form = document.getElementById('signinForm');
  const responseElem = document.getElementById('response');

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    const username = document.getElementById('username').value;
    const password = document.getElementById('password').value;

    try {
      const res = await AuthenticationService.postApiAuthSignin({ username, password });
      responseElem.textContent = JSON.stringify(res, null, 2);

      // ✅ ذخیره نام کاربر در localStorage
      localStorage.setItem('username', username);

      // ✅ انتقال به صفحه چت
      window.location.href = 'chat.html';
    } catch (err) {
      responseElem.textContent = 'Error: ' + JSON.stringify(err, null, 2);
    }
  });
</script>
</body>
</html>
